import{_ as N,r as u,n as V,a5 as q,c as y,a as i,o as f,b as s,d as e,f as T,s as B,h as x,F as P,p as R,j as M,g as O,t as d,l as Q}from"./index-D8k0Z2VW.js";import{Q as $}from"./QTd-Dz2_L_T4.js";import{Q as L}from"./QBadge-pToOuXWH.js";import{Q as z}from"./QPage-CDUm3vNP.js";import{B as U}from"./BackButton-OAicZK4q.js";import{P as H}from"./PageHeader-BZtJRD6F.js";import{S as j}from"./StatsCard-CWZ95buy.js";import{T as G}from"./Table-DrGgNztj.js";import{_ as h}from"./ButtonTableOptions-ivpzFDPv.js";import{B as J}from"./Button-ByZOtwGJ.js";import{M as K}from"./Modal-CwwUMTwV.js";import{g as W}from"./apiClient-Vvvjylwf.js";import"./QList-D6hH9GPe.js";import"./QSelect-CCFBgF8v.js";import"./QItemLabel-BiKvV_tR.js";import"./position-engine-BrzQKXCo.js";import"./selection-CjJDPdFp.js";import"./format-DyQxkAtJ.js";import"./QLinearProgress-C9Sex94R.js";import"./QTooltip-BIz5X8HU.js";const X={class:"full-width row"},Y={class:"col-12"},Z={class:"container"},ee={class:"cards-container q-mb-xl"},te={class:"q-pa-md flex flex-center column text-grey full-width"},ae={key:0,class:"row q-col-gutter-lg"},oe={class:"col-12 col-md-6"},se={class:"data-grid"},le={class:"data-row"},ie={class:"data-value"},ne={class:"data-row"},re={class:"data-value"},de={class:"data-row"},ce={class:"data-value"},ue={class:"data-row"},ve={class:"data-value"},me={class:"col-12 col-md-6"},pe={class:"data-grid"},fe={class:"data-row"},ge={class:"data-value"},_e={class:"data-row"},he={class:"data-value"},we={class:"data-row"},Ce={class:"data-value"},be={class:"data-row"},ye={class:"data-value"},xe={__name:"ReportByCompanyView",setup(Ee){const m=V(),n=u({empresa:m.query.empresa||null,tipoContrato:m.query.tipoContrato||null,estadoContrato:m.query.estadoContrato||null,anio:m.query.anio||null}),v=u([{title:"TOTAL EMPRESAS",value:0},{title:"APRENDICES VINCULADOS",value:0},{title:"FICHAS EN PROCESO",value:0}]),E=[{name:"empresa",label:"Empresa",field:"empresa",align:"left"},{name:"nit",label:"NIT",field:"nit",align:"center"},{name:"contrato",label:"Tipo Contrato",field:"contrato",align:"left"},{name:"aprendices",label:"Aprendices",field:"aprendices",align:"center"},{name:"fechaInicio",label:"Fecha Inicio",field:"fechaInicio",align:"center"},{name:"fechaFin",label:"Fecha Fin",field:"fechaFin",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",align:"center"}],g=u([]),_=u(!1),l=u(null),p=u(!1),I=async()=>{try{_.value=!0;const a=new URLSearchParams;n.value.empresa&&a.append("empresa",n.value.empresa),n.value.tipoContrato&&a.append("tipoContrato",n.value.tipoContrato),n.value.estadoContrato&&a.append("estadoContrato",n.value.estadoContrato),n.value.anio&&a.append("anio",n.value.anio);const t=`/reportes/empresa${a.toString()?`?${a.toString()}`:""}`,o=await W(t),r=o.aprendices||[];g.value=r.map(c=>({...c,fechaInicio:c.fechaInicio||c.fecha||"-",fechaFin:c.fechaFin||"-"})),o.resumen&&(v.value[0].value=o.resumen.totalEmpresas||o.resumen.totalAprendices||0,v.value[1].value=o.resumen.activos||0,v.value[2].value=o.resumen.finalizados||0)}catch{g.value=[],v.value=[{title:"TOTAL EMPRESAS",value:0},{title:"APRENDICES VINCULADOS",value:0},{title:"FICHAS EN PROCESO",value:0}]}finally{_.value=!1}};q(()=>{I()});function S(a){return{Activo:"positive",Inactivo:"negative",Pendiente:"orange",Finalizado:"blue","En Proceso":"info"}[a]||"grey"}function w(a){return a?new Date(a).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):null}function D(a,t){if(!a||!t)return"N/A";const o=new Date(a),r=new Date(t),c=Math.abs(r-o),C=Math.ceil(c/(1e3*60*60*24)),b=Math.floor(C/30);return b>0?`${b} meses`:`${C} días`}const F=a=>{l.value=a,p.value=!0},A=a=>{},k=a=>{};return(a,t)=>(f(),y(z,{class:"q-pa-md report-view-page"},{default:i(()=>[s(U,{class:"q-mb-lg"}),e("div",X,[e("div",Y,[s(T,{class:"shadow-1 hero-card q-mb-xl"},{default:i(()=>[s(B,null,{default:i(()=>[s(H,{title:"Reporte por Empresa",description:"Informes agrupados por empresa."})]),_:1})]),_:1}),e("div",Z,[e("div",ee,[(f(!0),x(P,null,R(v.value,(o,r)=>(f(),y(j,{key:r,title:o.title,value:o.value,color:o.color},null,8,["title","value","color"]))),128))]),s(G,{card:"",rows:g.value,columns:E,"row-key":"_id",loading:_.value},{"body-cell-acciones":i(o=>[s($,{props:o,class:"text-center table-options"},{default:i(()=>[s(h,{icon:"visibility",color:"grey",tooltip:"Ver detalle",onClick:r=>F(o.row)},null,8,["onClick"]),s(h,{icon:"file_download",color:"grey-7",tooltip:"Descargar",onClick:r=>A(o.row)},null,8,["onClick"]),s(h,{icon:"delete",color:"negative",tooltip:"Eliminar",onClick:r=>k(o.row)},null,8,["onClick"])]),_:2},1032,["props"])]),"no-data":i(()=>[e("div",te,[s(M,{name:"inventory",size:"2.5em",color:"positive"}),t[2]||(t[2]=e("div",{class:"text-subtitle2 q-mt-sm"}," No se encontraron registros para los filtros seleccionados ",-1))])]),_:1},8,["rows","loading"])])])]),s(K,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o),width:"1200px","max-width":"98vw"},{header:i(()=>[...t[3]||(t[3]=[e("div",{class:"modal-header-content"},[e("div",{class:"text-h6"},"Detalles del Reporte por Empresa")],-1)])]),body:i(()=>[l.value?(f(),x("div",ae,[e("div",oe,[t[8]||(t[8]=e("div",{class:"text-h6 q-mb-md section-title"},"Información de la Empresa",-1)),e("div",se,[e("div",le,[t[4]||(t[4]=e("div",{class:"text-weight-bold"},"Empresa:",-1)),e("div",ie,d(l.value.empresa||"-"),1)]),e("div",ne,[t[5]||(t[5]=e("div",{class:"text-weight-bold"},"NIT:",-1)),e("div",re,d(l.value.nit||"-"),1)]),e("div",de,[t[6]||(t[6]=e("div",{class:"text-weight-bold"},"Tipo de Contrato:",-1)),e("div",ce,d(l.value.contrato||"-"),1)]),e("div",ue,[t[7]||(t[7]=e("div",{class:"text-weight-bold"},"Estado:",-1)),e("div",ve,[s(L,{color:S(l.value.estado)},{default:i(()=>[Q(d(l.value.estado||"-"),1)]),_:1},8,["color"])])])])]),e("div",me,[t[13]||(t[13]=e("div",{class:"text-h6 q-mb-md section-title"},"Información del Contrato",-1)),e("div",pe,[e("div",fe,[t[9]||(t[9]=e("div",{class:"text-weight-bold"},"Aprendices Vinculados:",-1)),e("div",ge,d(l.value.aprendices||0),1)]),e("div",_e,[t[10]||(t[10]=e("div",{class:"text-weight-bold"},"Fecha de Inicio:",-1)),e("div",he,d(w(l.value.fechaInicio)||"-"),1)]),e("div",we,[t[11]||(t[11]=e("div",{class:"text-weight-bold"},"Fecha de Fin:",-1)),e("div",Ce,d(w(l.value.fechaFin)||"-"),1)]),e("div",be,[t[12]||(t[12]=e("div",{class:"text-weight-bold"},"Duración:",-1)),e("div",ye,d(D(l.value.fechaInicio,l.value.fechaFin)),1)])])])])):O("",!0)]),footer:i(()=>[s(J,{label:"Cerrar","custom-class":"boton-cerrar",onClick:t[0]||(t[0]=o=>p.value=!1)})]),_:1},8,["modelValue"])]),_:1}))}},He=N(xe,[["__scopeId","data-v-0f513035"]]);export{He as default};

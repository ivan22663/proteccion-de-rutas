import{_ as P,r as u,m as T,w as B,a5 as H,u as S,h as f,d as s,b as a,a as d,f as w,o as g,s as $,j as n,l,t as r,F as V,p as q,q as L}from"./index-D8k0Z2VW.js";import{u as F}from"./authStore-BiRtblIW.js";import{u as U}from"./useNotifications-C15CMF32.js";import{g as N}from"./apiClient-Vvvjylwf.js";import{M as Q}from"./Modal-CwwUMTwV.js";import{B as E}from"./Button-ByZOtwGJ.js";import{B as G}from"./BackButton-OAicZK4q.js";import{P as j}from"./PageHeader-BZtJRD6F.js";import{S as b}from"./StatsCard-CWZ95buy.js";const J={class:"q-pa-md"},K={class:"q-mb-lg"},W={class:"full-width row"},X={class:"col-12"},Y={class:"statistics-section q-mb-xl"},Z={class:"stats-grid"},ee={class:"informe-container"},se={class:"cards-grid"},ae={class:"card-header"},te={class:"info-item"},oe={class:"item-label"},ie={class:"item-value"},ne={class:"info-item"},re={class:"item-label"},le={class:"item-value"},de={class:"info-item"},ce={class:"item-label"},ue={class:"item-value"},me={class:"info-item"},ve={class:"item-label"},pe={class:"item-value"},_e={class:"card-header"},he={class:"info-item"},fe={class:"item-label"},ge={class:"item-value"},be={class:"info-item"},ye={class:"item-label"},we={class:"item-value"},xe={class:"info-item"},ke={class:"item-label"},Ae={class:"item-value"},Ce={class:"info-item"},Ie={class:"item-label"},ze={class:"item-value"},Oe={class:"card-header"},Ne={key:0,class:"fichas-content"},Ee={class:"info-item"},Re={class:"item-label"},De={class:"ficha-badge"},Me={class:"info-item"},Pe={class:"item-label"},Te={class:"item-value"},Be={key:1,class:"empty-state"},He={class:"horas-section-internal q-mt-lg"},Se={class:"horas-content"},$e={class:"horas-valor"},Ve={class:"text-h6"},qe={style:{"font-size":"1.1rem"}},Le={__name:"PersonalReport",setup(Fe){const O=S(),x=F(),k=U(),t=u({_id:"",name:"",email:"",emailpersonal:"",numdocument:"",tpdocument:"",phone:"",thematicarea:"",bindingtype:"",knowledge:"",caphour:0,hourswork:0,status:0}),p=u(!1),A=u(""),C=u(""),I=u(!1),_=u({schedules:0,projects:0,pendingActivities:0}),z=T(()=>{const o=x.user;return o?._id||o?.id||o?.uid});function y(o){if(!o)return null;if(typeof o=="string")return o;if(o.$oid)return o.$oid;if(o._id){if(typeof o._id=="string")return o._id;if(o._id.$oid)return o._id.$oid}return null}const h=u([]);async function R(){if(!z.value){k.error("No se pudo identificar al instructor"),O.push("/login");return}try{const e=(await N(`/statistics/instructor/personal-stats?instructorId=${z.value}`))?.data;if(e&&typeof e=="object"){const i=e.instructor||e;t.value={_id:y(i)||i._id||z.value,name:i.name||"",email:"",emailpersonal:"",numdocument:"",tpdocument:"",phone:"",thematicarea:i.thematicarea||"",bindingtype:"",knowledge:"",caphour:i.caphour||0,hourswork:i.hourswork||0,status:i.status??1},_.value={schedules:e.schedules||0,projects:e.projects||0,pendingActivities:e.pendingActivities||0},h.value=[];try{const m=(await N("/instructors/instructorById"))?.msg;if(m&&m.instructor){const c=m.instructor;t.value={...t.value,email:c.email||t.value.email,emailpersonal:c.emailpersonal||t.value.emailpersonal,numdocument:c.numdocument||t.value.numdocument,tpdocument:c.tpdocument||t.value.tpdocument,phone:c.phone||t.value.phone,bindingtype:c.bindingtype||t.value.bindingtype,knowledge:c.knowledge||t.value.knowledge},m.fiches&&Array.isArray(m.fiches)&&(h.value=m.fiches.map(v=>({_id:y(v)||v._id,number:v.number||"",program:{_id:y(v.program)||v.program?._id,name:v.program?.name||""}})))}}catch{}}else throw new Error("Datos del instructor no disponibles en el backend")}catch(o){const e=x.user;if(e)t.value={_id:y(e)||e._id,name:e.name||"",email:e.email||"",emailpersonal:e.emailpersonal||"",numdocument:e.numdocument||"",tpdocument:e.tpdocument||"",phone:e.phone||"",thematicarea:e.thematicarea||"",bindingtype:e.bindingtype||"",knowledge:e.knowledge||"",caphour:e.caphour||0,hourswork:e.hourswork||0,status:e.status??0},_.value={schedules:0,projects:0,pendingActivities:0},h.value=[];else{const i=o.response?.data?.msg||o.response?.data?.message||"No se pudieron cargar los datos del instructor";k.error(i)}}}B(()=>t.value.hourswork,async o=>{await L(),I.value||(o>=155&&o<160?(A.value="Alerta de Horas Acumuladas",C.value=`El instructor ${t.value.name} ha acumulado ${o} horas. Está próximo a alcanzar el límite máximo de 160 horas.`,p.value=!0,I.value=!0):o>=160&&(A.value="Límite de Horas Alcanzado",C.value=`El instructor ${t.value.name} ha alcanzado el máximo de 160 horas. No puede continuar acumulando más horas hasta que se gestione el pago o compensación.`,p.value=!0,I.value=!0))},{immediate:!0});const D=()=>{p.value=!1};return H(async()=>{if(!x.isAuthenticated){k.warning("Debes iniciar sesión para acceder a esta página"),O.push("/login");return}await R()}),(o,e)=>(g(),f("div",J,[s("div",K,[a(G)]),s("div",W,[s("div",X,[a(w,{class:"shadow-1 hero-card q-mb-xl"},{default:d(()=>[a($,null,{default:d(()=>[a(j,{title:"Mis Datos Personales",description:"Consulta y visualiza toda tu información personal, académica y las fichas asignadas a tu cargo."})]),_:1})]),_:1})])]),s("div",Y,[s("div",Z,[a(b,{title:"Horas Trabajadas",value:t.value.hourswork,color:"var(--color-primary)"},null,8,["value"]),a(b,{title:"Capacidad de Horas",value:t.value.caphour,color:"var(--color-primary)"},null,8,["value"]),a(b,{title:"Horarios",value:_.value.schedules,color:"var(--color-primary)"},null,8,["value"]),a(b,{title:"Proyectos",value:_.value.projects,color:"var(--color-primary)"},null,8,["value"]),a(b,{title:"Actividades Pendientes",value:_.value.pendingActivities,color:"var(--color-primary)"},null,8,["value"])])]),s("div",ee,[s("div",se,[a(w,{class:"info-card"},{default:d(()=>[s("div",ae,[a(n,{name:"person",size:"24px",class:"header-icon"}),e[2]||(e[2]=s("h2",{class:"card-title"},"Información Personal",-1))]),e[7]||(e[7]=s("div",{class:"card-divider"},null,-1)),s("div",te,[s("div",oe,[a(n,{name:"badge",size:"18px",color:"green"}),e[3]||(e[3]=l(" NOMBRE COMPLETO ",-1))]),s("div",ie,r(t.value.name||"-"),1)]),s("div",ne,[s("div",re,[a(n,{name:"description",size:"18px",color:"green"}),e[4]||(e[4]=l(" DOCUMENTO ",-1))]),s("div",le,r(t.value.numdocument||"-"),1)]),s("div",de,[s("div",ce,[a(n,{name:"email",size:"18px",color:"green"}),e[5]||(e[5]=l(" CORREO PERSONAL ",-1))]),s("div",ue,r(t.value.emailpersonal||"-"),1)]),s("div",me,[s("div",ve,[a(n,{name:"business",size:"18px",color:"green"}),e[6]||(e[6]=l(" CORREO INSTITUCIONAL ",-1))]),s("div",pe,r(t.value.email||"-"),1)])]),_:1}),a(w,{class:"info-card"},{default:d(()=>[s("div",_e,[a(n,{name:"school",size:"24px",class:"header-icon"}),e[8]||(e[8]=s("h2",{class:"card-title"},"Información Académica",-1))]),e[13]||(e[13]=s("div",{class:"card-divider"},null,-1)),s("div",he,[s("div",fe,[a(n,{name:"phone",size:"18px",color:"green"}),e[9]||(e[9]=l(" TELÉFONO ",-1))]),s("div",ge,r(t.value.phone||"-"),1)]),s("div",be,[s("div",ye,[a(n,{name:"folder",size:"18px",color:"green"}),e[10]||(e[10]=l(" ÁREA TEMÁTICA ",-1))]),s("div",we,r(t.value.thematicarea||"-"),1)]),s("div",xe,[s("div",ke,[a(n,{name:"link",size:"18px",color:"green"}),e[11]||(e[11]=l(" TIPO DE VINCULACIÓN ",-1))]),s("div",Ae,r(t.value.bindingtype||"-"),1)]),s("div",Ce,[s("div",Ie,[a(n,{name:"lightbulb",size:"18px",color:"green"}),e[12]||(e[12]=l(" CONOCIMIENTOS ",-1))]),s("div",ze,r(t.value.knowledge||"-"),1)])]),_:1}),a(w,{class:"info-card"},{default:d(()=>[s("div",Oe,[a(n,{name:"assignment",size:"24px",class:"header-icon"}),e[14]||(e[14]=s("h2",{class:"card-title"},"Fichas Asignadas",-1))]),e[19]||(e[19]=s("div",{class:"card-divider"},null,-1)),h.value.length>0?(g(),f("div",Ne,[(g(!0),f(V,null,q(h.value,i=>(g(),f("div",{key:i._id,class:"ficha-block"},[s("div",Ee,[s("div",Re,[a(n,{name:"folder_open",size:"18px",color:"green"}),e[15]||(e[15]=l(" FICHA ",-1))]),s("div",De,r(i.number),1)]),s("div",Me,[s("div",Pe,[a(n,{name:"school",size:"18px",color:"green"}),e[16]||(e[16]=l(" PROGRAMA ",-1))]),s("div",Te,r(i.program?.name||"Programa no especificado"),1)])]))),128))])):(g(),f("div",Be,[a(n,{name:"info",size:"40px",color:"grey-5"}),e[17]||(e[17]=s("p",null,"No tienes fichas asignadas en este momento.",-1))])),s("div",He,[a(E,{"custom-class":"horas-box-internal",to:{path:"/app/instructor/vistaHoras"},noCaps:!0,"aria-label":"Ver horas acumuladas por pagar"},{default:d(()=>[s("div",Se,[e[18]||(e[18]=s("div",{class:"horas-label"},"Horas acumuladas por pagar:",-1)),s("div",$e,r(t.value.hourswork||0),1)])]),_:1})])]),_:1})])]),a(Q,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=i=>p.value=i),width:"450px"},{header:d(()=>[s("div",Ve,r(A.value),1)]),body:d(()=>[s("div",qe,r(C.value),1)]),footer:d(()=>[a(E,{label:"Entendido","custom-class":"gradient-btn",noCaps:!0,onClick:e[0]||(e[0]=i=>D())})]),_:1},8,["modelValue"])]))}},Ze=P(Le,[["__scopeId","data-v-61cfcb38"]]);export{Ze as default};

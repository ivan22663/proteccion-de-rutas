import{_ as R,r as v,a5 as q,h as B,b as t,d as e,a as l,f as w,o as O,s as y,ah as k,e as c,i as U,l as g,j as Q}from"./index-D8k0Z2VW.js";import{u as L}from"./useNotifications-C15CMF32.js";import{u as j}from"./useEntityManager-6kUzRwOq.js";import{a as E}from"./apiClient-Vvvjylwf.js";import{B as F}from"./BackButton-OAicZK4q.js";import{B as b}from"./Button-ByZOtwGJ.js";import{M as Y}from"./Modal-CwwUMTwV.js";import{P as G}from"./PageHeader-BZtJRD6F.js";const z={class:"q-pa-md"},H={class:"full-width row"},$={class:"col-12"},J={class:"container"},K={class:"form-row"},W={class:"form-input-group"},X={class:"form-row"},Z={class:"form-input-group"},aa={class:"form-actions"},ea={class:"modal-header"},sa={class:"text-h6 flex items-center"},oa={class:"row justify-end q-gutter-sm full-width"},ta={__name:"Security",setup(ra){const P=()=>({_id:"",name:"",value:0,description:"",category:"SECURITY"}),m={list:"/parameters/filterParameters",update:s=>`/parameters/updateParameter/${s}`},x={listError:"Error al cargar los parámetros",noData:"No hay parámetros registrados"},I=s=>{const a=s?.data||s?.msg||[];return{data:a,total:a.length}},{loadingTable:C,loading:d,rows:f,filtersData:_,fetchEntities:N}=j({entityName:"parameter",entityNamePlural:"parameters",getDefaultFormData:P,endpoints:m,messages:x,processResponse:I}),{error:S,success:T}=L(),u=v(!1),i=v(!1),n=v(48);_.value.category="SECURITY";const p=async()=>{_.value.category="SECURITY",await N();const s=f.value,a=s.find(r=>r.name==="CONTRASEÑA TEMPORAL INICIAL"),o=s.find(r=>r.name==="TIEMPO DE SESION");a&&(i.value=a.value),o&&(n.value=Number(o.value))},A=s=>{n.value=s},D=s=>{i.value=s},V=()=>{u.value=!0},h=()=>{u.value=!1},M=async()=>{d.value=!0;try{const s=f.value.find(r=>r.name==="CONTRASEÑA TEMPORAL INICIAL"),a=f.value.find(r=>r.name==="TIEMPO DE SESION"),o=[];s&&s.value!==i.value&&o.push(E(m.update(s._id),{value:i.value})),a&&Number(a.value)!==Number(n.value)&&o.push(E(m.update(a._id),{value:Number(n.value)})),o.length&&await Promise.all(o),T("Configuración guardada exitosamente"),h(),await p()}catch{S("Error al guardar la configuración"),await p()}finally{d.value=!1}};return q(()=>{p()}),(s,a)=>(O(),B("div",z,[t(F),e("div",H,[e("div",$,[t(w,{class:"shadow-1 hero-card q-mb-xl"},{default:l(()=>[t(y,{class:"flex flex-center"},{default:l(()=>[t(G,{title:"Parámetros de Seguridad y Control de Acceso",description:"Ajusta roles, permisos y políticas de seguridad.",align:"center"})]),_:1})]),_:1})])]),e("div",J,[t(w,{class:"section-card q-mb-lg"},{default:l(()=>[a[6]||(a[6]=e("div",{class:"section-header"},[e("div",{class:"header-title"},"Credenciales y Acceso")],-1)),t(y,{class:"section-content"},{default:l(()=>[e("div",K,[a[3]||(a[3]=e("label",{class:"form-label"},"Forzar cambio al iniciar sesión",-1)),e("div",W,[t(k,{modelValue:i.value,"onUpdate:modelValue":[a[0]||(a[0]=o=>i.value=o),D],color:"green",disable:c(d)},null,8,["modelValue","disable"])])]),e("div",X,[a[5]||(a[5]=e("label",{class:"form-label"},"Tiempo de sesión",-1)),e("div",Z,[t(U,{modelValue:n.value,"onUpdate:modelValue":[a[1]||(a[1]=o=>n.value=o),A],modelModifiers:{number:!0},type:"number",outlined:"",dense:"",class:"custom-input",loading:c(C),min:1,max:720},null,8,["modelValue","loading"]),a[4]||(a[4]=e("span",{class:"input-hint"},"hrs",-1))])]),e("div",aa,[t(b,{label:"Guardar Configuración","custom-class":"gradient-btn",loading:c(C),onClick:V},null,8,["loading"])])]),_:1})]),_:1})]),t(Y,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=o=>u.value=o),width:"500px","max-width":"95vw",persistent:"","show-footer-separator":!1},{header:l(()=>[e("div",ea,[e("div",sa,[t(Q,{name:"help",class:"q-mr-sm"}),a[7]||(a[7]=g(" Confirmación de Cambios ",-1))])])]),body:l(()=>[...a[8]||(a[8]=[e("div",{class:"q-pa-md text-center"},[e("div",{class:"text-h6 q-mb-md"},"¿Está seguro de que desea guardar los cambios?"),e("p",{class:"confirmation-text text-body1"},[g(" ¿Desea guardar la configuración de "),e("strong",null,"SEGURIDAD"),g("? ")])],-1)])]),footer:l(()=>[e("div",oa,[t(b,{label:"Cancelar","custom-class":"boton-cerrar",onClick:h}),t(b,{label:"Aceptar","custom-class":"gradient-btn",loading:c(d),onClick:M},null,8,["loading"])])]),_:1},8,["modelValue"])]))}},pa=R(ta,[["__scopeId","data-v-545f4602"]]);export{pa as default};

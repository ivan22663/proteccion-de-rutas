import{_ as X,a5 as Y,c as Z,a as i,o as R,b as l,d as e,f as tt,s as et,i as st,e as o,j as m,af as C,l as n,t as r,z as at,h as ot,g as it}from"./index-D8k0Z2VW.js";import{Q as lt,a as I}from"./QSelect-CCFBgF8v.js";import{Q as c}from"./QTd-Dz2_L_T4.js";import{Q as A}from"./QBadge-pToOuXWH.js";import{Q as rt}from"./QPage-CDUm3vNP.js";import{C as dt}from"./ClosePopup-DkFGp95i.js";import{u as nt}from"./useEntityManager-6kUzRwOq.js";import{B as P}from"./Button-ByZOtwGJ.js";import{T as ct}from"./Table-DrGgNztj.js";import{M as ut}from"./Modal-CwwUMTwV.js";import{_ as mt}from"./ButtonTableOptions-ivpzFDPv.js";import{P as pt}from"./PageHeader-BZtJRD6F.js";import{B as gt}from"./BackButton-OAicZK4q.js";import"./QItemLabel-BiKvV_tR.js";import"./position-engine-BrzQKXCo.js";import"./selection-CjJDPdFp.js";import"./format-DyQxkAtJ.js";import"./apiClient-Vvvjylwf.js";import"./useNotifications-C15CMF32.js";import"./QList-D6hH9GPe.js";import"./QLinearProgress-C9Sex94R.js";import"./QTooltip-BIz5X8HU.js";const vt={class:"full-width row"},ft={class:"col-12"},_t={class:"filters-wrapper flex items-center justify-between q-my-lg"},bt={class:"filters-left flex items-center bg-white"},yt={class:"filter-item search"},ht={class:"filter-item status"},wt={class:"actions-right row items-center q-gutter-sm"},xt={class:"text-weight-medium"},Nt={class:"text-caption text-grey-7"},Dt={class:"text-weight-medium"},Et={class:"text-caption text-grey-7"},Rt={class:"text-caption"},Ct={class:"text-caption"},It={class:"q-pa-md flex flex-center column text-grey full-width"},At={class:"modal-header"},Pt={class:"text-h6 flex items-center"},Vt={key:0,class:"modal-content-grid"},St={class:"modal-column"},kt={class:"data-grid"},qt={class:"data-row"},Qt={class:"data-value"},jt={class:"data-row"},zt={class:"data-value"},Bt={class:"data-row"},Mt={class:"data-value"},Ht={class:"modal-column"},Lt={class:"data-grid"},Tt={class:"data-row"},Ut={class:"data-value"},$t={class:"data-row"},Ft={class:"data-value"},Ot={class:"data-row"},Gt={class:"data-value"},Jt={class:"data-row"},Kt={class:"data-value"},Wt={class:"modal-column"},Xt={class:"data-grid"},Yt={class:"data-row"},Zt={class:"data-value"},te={class:"data-row"},ee={class:"data-value"},se={class:"data-row"},ae={class:"data-value"},oe={class:"modal-column"},ie={class:"data-grid"},le={class:"data-row"},re={class:"data-value"},de={class:"data-row"},ne={class:"data-value"},ce={class:"data-row"},ue={class:"data-value"},me={class:"data-row"},pe={class:"data-value"},ge={class:"data-row"},ve={class:"data-value"},fe={__name:"Registration",setup(_e){const V=()=>({_id:"",registrationNumber:"",modalityId:null,companyId:null,apprenticeId:null,scheduledStartDate:"",totalRequestedHours:0,workingDays:5,dailyHours:8,status:0}),S={list:"/registrations/listRegistrations",create:"/registrations/saveRegistration",update:s=>`/registrations/updateRegistration/${s}`,activate:s=>`/registrations/activateRegistration/${s}`,deactivate:s=>`/registrations/deactivateRegistration/${s}`},k={listError:"Error al listar registros de etapa productiva",createSuccess:"Registro de etapa productiva creado correctamente",createError:"Error al crear registro",updateSuccess:"Registro actualizado correctamente",updateError:"Error al actualizar registro",statusSuccess:"Estado actualizado correctamente",statusError:"No fue posible cambiar el estado",noData:"No hay registros de etapa productiva"},q=s=>{const t=s?.msg?.registrations||s?.msg||[],a=s?.msg?.totalDocuments||t.length;return{data:Array.isArray(t)?t:[],total:a}},{loadingTable:Q,rows:j,showDetailDialog:p,selectedEntity:z,filtersData:u,pagination:g,handlePaginationRequest:B,handleSearchChange:M,handleStatusChange:H,openDetailsDialog:L,fetchEntities:T}=nt({entityName:"registro",entityNamePlural:"registros",getDefaultFormData:V,endpoints:S,messages:k,processResponse:q}),U=j,d=z,$=L,y=T,F=[{name:"registrationNumber",label:"Nº Registro",align:"center",field:"registrationNumber",sortable:!0},{name:"apprentice",label:"Aprendiz",align:"left",field:s=>v(s),sortable:!0},{name:"company",label:"Empresa",align:"left",field:s=>f(s)},{name:"modality",label:"Modalidad",align:"center",field:"modalityId"},{name:"dates",label:"Información",align:"center",field:"scheduledStartDate"},{name:"status",label:"Estado",align:"center",field:"status",sortable:!0},{name:"options",label:"Acciones",align:"center"}],O=[{label:"Todos los estados",value:""},{label:"Activo",value:0},{label:"Inactivo",value:1}],v=s=>{if(!s)return"-";const t=s.apprenticeId;return typeof t=="object"&&t!==null&&`${t.firstName||""} ${t.lastName||""}`.trim()||"-"},h=s=>{if(!s)return"-";const t=s.apprenticeId;return typeof t=="object"&&t!==null&&t.documentNumber||"-"},G=s=>{if(!s)return"-";const t=s.apprenticeId;return typeof t=="object"&&t!==null&&(t.email?.personal||t.email?.institutional)||"-"},J=s=>{if(!s)return"-";const t=s.apprenticeId;return typeof t=="object"&&t!==null&&t.phone||"-"},f=s=>{if(!s)return"-";const t=s.companyId;return typeof t=="object"&&t!==null&&t.name||"-"},w=s=>{if(!s)return"-";const t=s.companyId;return typeof t=="object"&&t!==null&&t.companyNit||"-"},K=s=>{if(!s)return"-";const t=s.companyId;return typeof t=="object"&&t!==null&&t.location||"-"},_=s=>s?typeof s=="object"&&s!==null?s.name||"-":s:"-",x=s=>{const t=_(s),a={"Contrato de Aprendizaje":"blue",Pasantía:"green","Vinculación Laboral":"purple","Proyecto Productivo":"orange",Monitoría:"teal","Unidad Productiva Familiar":"pink"};for(const[E,W]of Object.entries(a))if(t.toLowerCase().includes(E.toLowerCase()))return W;return"grey"},N=s=>s===0?"positive":"negative",D=s=>s===0?"Activo":"Inactivo",b=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"})}catch{return"-"}};return Y(async()=>{await y()}),(s,t)=>(R(),Z(rt,{class:"q-pa-md registro-ep-page"},{default:i(()=>[l(gt,{class:"q-mb-lg"}),e("div",vt,[e("div",ft,[l(tt,{class:"shadow-1 hero-card q-mb-xl"},{default:i(()=>[l(et,null,{default:i(()=>[l(pt,{title:"Registros de Etapa Productiva",description:"Visualiza y gestiona los registros de etapa productiva de los aprendices."})]),_:1})]),_:1}),e("div",_t,[e("div",bt,[e("div",yt,[l(st,{modelValue:o(u).search,"onUpdate:modelValue":[t[0]||(t[0]=a=>o(u).search=a),o(M)],outlined:"",dense:"",clearable:"",debounce:"600",placeholder:"Buscar por documento de aprendiz..."},{prepend:i(()=>[l(m,{name:"search",color:"grey-7"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),e("div",ht,[l(lt,{modelValue:o(u).status,"onUpdate:modelValue":[t[1]||(t[1]=a=>o(u).status=a),o(H)],options:O,outlined:"",dense:"","emit-value":"","map-options":"",clearable:"",label:"Filtrar por Estado"},{prepend:i(()=>[l(m,{name:"filter_list",color:"green-8"})]),_:1},8,["modelValue","onUpdate:modelValue"])])]),e("div",wt,[l(P,{label:"Actualizar Lista","custom-class":"gradient-btn",icon:"refresh",onClick:o(y)},null,8,["onClick"])])]),l(ct,{card:"",rows:o(U),columns:F,pagination:o(g),"onUpdate:pagination":t[2]||(t[2]=a=>C(g)?g.value=a:null),"loading-table":o(Q),"row-key":"_id",onRequest:o(B)},{"body-cell-apprentice":i(a=>[l(c,{props:a},{default:i(()=>[e("div",xt,r(v(a.row)),1),e("div",Nt,r(h(a.row)),1)]),_:2},1032,["props"])]),"body-cell-modality":i(a=>[l(c,{props:a},{default:i(()=>[l(I,{color:x(a.row.modalityId),"text-color":"white",dense:"",class:"text-uppercase"},{default:i(()=>[n(r(_(a.row.modalityId)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-company":i(a=>[l(c,{props:a},{default:i(()=>[e("div",Dt,r(f(a.row)),1),e("div",Et,r(w(a.row)),1)]),_:2},1032,["props"])]),"body-cell-dates":i(a=>[l(c,{props:a},{default:i(()=>[e("div",Rt,[t[4]||(t[4]=e("strong",null,"Inicio:",-1)),n(" "+r(b(a.row.scheduledStartDate)),1)]),e("div",Ct,[t[5]||(t[5]=e("strong",null,"Horas:",-1)),n(" "+r(a.row.totalRequestedHours||"N/A"),1)])]),_:2},1032,["props"])]),"body-cell-status":i(a=>[l(c,{props:a},{default:i(()=>[l(A,{color:N(a.row.status),class:"text-uppercase"},{default:i(()=>[n(r(D(a.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-options":i(a=>[l(c,{props:a,class:"text-center table-options"},{default:i(()=>[l(mt,{icon:"visibility",color:"primary",tooltip:"Ver Detalles",onClick:E=>o($)(a.row)},null,8,["onClick"])]),_:2},1032,["props"])]),"no-data":i(()=>[e("div",It,[l(m,{name:"assignment",size:"2.5em",color:"positive"}),t[6]||(t[6]=e("div",{class:"text-subtitle2 q-mt-sm"}," No hay registros de etapa productiva ",-1))])]),_:1},8,["rows","pagination","loading-table","onRequest"]),l(ut,{modelValue:o(p),"onUpdate:modelValue":t[3]||(t[3]=a=>C(p)?p.value=a:null),width:"900px","max-width":"90vw"},{header:i(()=>[e("div",At,[e("div",Pt,[l(m,{name:"assignment",class:"q-mr-sm"}),t[7]||(t[7]=n(" Detalles del Registro de Etapa Productiva ",-1))])])]),body:i(()=>[o(d)?(R(),ot("div",Vt,[e("div",St,[t[11]||(t[11]=e("div",{class:"section-title"},"Información del Registro",-1)),e("div",kt,[e("div",qt,[t[8]||(t[8]=e("div",{class:"text-weight-bold"},"Número de Registro:",-1)),e("div",Qt,r(o(d)?.registrationNumber||"-"),1)]),e("div",jt,[t[9]||(t[9]=e("div",{class:"text-weight-bold"},"Estado:",-1)),e("div",zt,[l(A,{color:N(o(d)?.status),class:"text-uppercase"},{default:i(()=>[n(r(D(o(d)?.status)),1)]),_:1},8,["color"])])]),e("div",Bt,[t[10]||(t[10]=e("div",{class:"text-weight-bold"},"Fecha de Creación:",-1)),e("div",Mt,r(b(o(d)?.createdAt)),1)])])]),e("div",Ht,[t[16]||(t[16]=e("div",{class:"section-title"},"Información del Aprendiz",-1)),e("div",Lt,[e("div",Tt,[t[12]||(t[12]=e("div",{class:"text-weight-bold"},"Nombre:",-1)),e("div",Ut,r(v(o(d))),1)]),e("div",$t,[t[13]||(t[13]=e("div",{class:"text-weight-bold"},"Documento:",-1)),e("div",Ft,r(h(o(d))),1)]),e("div",Ot,[t[14]||(t[14]=e("div",{class:"text-weight-bold"},"Email:",-1)),e("div",Gt,r(G(o(d))),1)]),e("div",Jt,[t[15]||(t[15]=e("div",{class:"text-weight-bold"},"Teléfono:",-1)),e("div",Kt,r(J(o(d))),1)])])]),e("div",Wt,[t[20]||(t[20]=e("div",{class:"section-title"},"Información de la Empresa",-1)),e("div",Xt,[e("div",Yt,[t[17]||(t[17]=e("div",{class:"text-weight-bold"},"Empresa:",-1)),e("div",Zt,r(f(o(d))),1)]),e("div",te,[t[18]||(t[18]=e("div",{class:"text-weight-bold"},"NIT:",-1)),e("div",ee,r(w(o(d))),1)]),e("div",se,[t[19]||(t[19]=e("div",{class:"text-weight-bold"},"Ubicación:",-1)),e("div",ae,r(K(o(d))),1)])])]),e("div",oe,[t[26]||(t[26]=e("div",{class:"section-title"},"Detalles de la Etapa Productiva",-1)),e("div",ie,[e("div",le,[t[21]||(t[21]=e("div",{class:"text-weight-bold"},"Modalidad:",-1)),e("div",re,[l(I,{color:x(o(d)?.modalityId),"text-color":"white",dense:""},{default:i(()=>[n(r(_(o(d)?.modalityId)),1)]),_:1},8,["color"])])]),e("div",de,[t[22]||(t[22]=e("div",{class:"text-weight-bold"},"Fecha Programada:",-1)),e("div",ne,r(b(o(d)?.scheduledStartDate)),1)]),e("div",ce,[t[23]||(t[23]=e("div",{class:"text-weight-bold"},"Horas Solicitadas:",-1)),e("div",ue,r(o(d)?.totalRequestedHours||"N/A"),1)]),e("div",me,[t[24]||(t[24]=e("div",{class:"text-weight-bold"},"Días Laborales:",-1)),e("div",pe,r(o(d)?.workingDays||"N/A"),1)]),e("div",ge,[t[25]||(t[25]=e("div",{class:"text-weight-bold"},"Horas Diarias:",-1)),e("div",ve,r(o(d)?.dailyHours||"N/A"),1)])])])])):it("",!0)]),footer:i(()=>[at(l(P,{label:"Cerrar","custom-class":"boton-cerrar"},null,512),[[dt]])]),_:1},8,["modelValue"])])])]),_:1}))}},He=X(fe,[["__scopeId","data-v-f8390ad7"]]);export{He as default};

import{_ as O,r as c,a5 as U,h as q,b as t,d as e,a as l,f as E,o as P,s as I,ah as B,e as u,i as k,l as p,j as Q}from"./index-D8k0Z2VW.js";import{u as G}from"./useNotifications-C15CMF32.js";import{u as L}from"./useEntityManager-6kUzRwOq.js";import{a as V}from"./apiClient-Vvvjylwf.js";import{B as T}from"./BackButton-OAicZK4q.js";import{B as g}from"./Button-ByZOtwGJ.js";import{M as H}from"./Modal-CwwUMTwV.js";import{P as j}from"./PageHeader-BZtJRD6F.js";const z={class:"q-pa-md"},$={class:"full-width row"},J={class:"col-12"},K={class:"container"},W={class:"form-row"},X={class:"form-input-group"},Y={class:"form-row"},Z={class:"form-input-group"},aa={class:"form-actions"},ea={class:"modal-header"},sa={class:"text-h6 flex items-center"},ta={class:"row justify-end q-gutter-sm full-width"},oa={__name:"Storage",setup(la){const y=()=>({_id:"",name:"",value:0,description:"",category:"FILES"}),m={list:"/parameters/filterParameters",update:s=>`/parameters/updateParameter/${s}`},x={listError:"Error al cargar los parámetros de validación",noData:"No hay parámetros registrados"},D=s=>{const a=s?.data?.data||s?.data?.parameters||s?.data||[];return{data:a,total:a.length}},{loadingTable:v,loading:i,rows:w,filtersData:C,fetchEntities:F}=L({entityName:"parameter",entityNamePlural:"parameters",getDefaultFormData:y,endpoints:m,messages:x,processResponse:D}),{error:h,success:N}=G(),d=c(!1),n=c(!0),r=c(15),f=c({});C.value.category="FILES";const _=async()=>{C.value.category="FILES",await F(),w.value.forEach(a=>{!a?.name||!a?._id||(f.value[a.name]=a._id,a.name==="VERIFICACION DE DOCUMENTOS FIRMADOS"&&(n.value=a.value),a.name==="FRECUENCIA CARGUE ARCHIVOS"&&(r.value=a.value))})},A=s=>{n.value=s},S=s=>{r.value=s},R=()=>{d.value=!0},b=()=>{d.value=!1},M=async()=>{i.value=!0;try{const s=f.value["VERIFICACION DE DOCUMENTOS FIRMADOS"],a=f.value["FRECUENCIA CARGUE ARCHIVOS"],o=[];if(s&&o.push(V(m.update(s),{value:n.value})),a&&o.push(V(m.update(a),{value:Number(r.value)})),!o.length){h("No se encontraron los parámetros para actualizar");return}await Promise.all(o),N("Configuración guardada exitosamente"),b(),await _()}catch(s){const a=s?.response?.data?.message||s?.response?.data?.msg||s?.message||"Error al guardar la configuración";h(a)}finally{i.value=!1}};return U(()=>{_()}),(s,a)=>(P(),q("div",z,[t(T),e("div",$,[e("div",J,[t(E,{class:"shadow-1 hero-card q-mb-xl"},{default:l(()=>[t(I,{class:"flex flex-center"},{default:l(()=>[t(j,{title:"Administración de Espacio y Rutas de Archivos",description:"Gestiona rutas, almacenamiento y limpieza de archivos.",align:"center"})]),_:1})]),_:1})])]),e("div",K,[t(E,{class:"section-card"},{default:l(()=>[a[6]||(a[6]=e("div",{class:"section-header"},[e("div",{class:"header-title"},"Validaciones de Documentos")],-1)),t(I,{class:"section-content"},{default:l(()=>[e("div",W,[a[3]||(a[3]=e("label",{class:"form-label"},"Validación de firmas, docs firmados",-1)),e("div",X,[t(B,{modelValue:n.value,"onUpdate:modelValue":[a[0]||(a[0]=o=>n.value=o),A],color:"green",disable:u(i)},null,8,["modelValue","disable"])])]),e("div",Y,[a[5]||(a[5]=e("label",{class:"form-label"},"Frecuencia cargue archivos",-1)),e("div",Z,[t(k,{modelValue:r.value,"onUpdate:modelValue":[a[1]||(a[1]=o=>r.value=o),S],modelModifiers:{number:!0},type:"number",outlined:"",dense:"",class:"custom-input",loading:u(v),min:1,max:365},null,8,["modelValue","loading"]),a[4]||(a[4]=e("span",{class:"input-hint"},"días",-1))])]),e("div",aa,[t(g,{label:"Guardar Configuración","custom-class":"gradient-btn",loading:u(v),onClick:R},null,8,["loading"])])]),_:1})]),_:1})]),t(H,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=o=>d.value=o),width:"500px","max-width":"95vw",persistent:"","show-footer-separator":!1},{header:l(()=>[e("div",ea,[e("div",sa,[t(Q,{name:"help",class:"q-mr-sm"}),a[7]||(a[7]=p(" Confirmación de Cambios ",-1))])])]),body:l(()=>[...a[8]||(a[8]=[e("div",{class:"q-pa-md text-center"},[e("div",{class:"text-h6 q-mb-md"},"¿Está seguro de que desea guardar los cambios?"),e("p",{class:"confirmation-text text-body1"},[p(" ¿Desea guardar la configuración de "),e("strong",null,"VALIDACIONES"),p("? ")])],-1)])]),footer:l(()=>[e("div",ta,[t(g,{label:"Cancelar","custom-class":"boton-cerrar",onClick:b}),t(g,{label:"Aceptar","custom-class":"gradient-btn",loading:u(i),onClick:M},null,8,["loading"])])]),_:1},8,["modelValue"])]))}},pa=O(oa,[["__scopeId","data-v-46f961d3"]]);export{pa as default};

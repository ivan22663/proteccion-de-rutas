import{_ as D,r as u,n as N,a5 as B,c as b,a as i,o as f,b as s,d as a,f as V,s as M,h as y,F as E,p as Q,j as T,g as L,t as r,l as x}from"./index-D8k0Z2VW.js";import{Q as R}from"./QTd-Dz2_L_T4.js";import{Q as C}from"./QBadge-pToOuXWH.js";import{Q as H}from"./QPage-CDUm3vNP.js";import{B as O}from"./BackButton-OAicZK4q.js";import{P as $}from"./PageHeader-BZtJRD6F.js";import{S as z}from"./StatsCard-CWZ95buy.js";import{T as U}from"./Table-DrGgNztj.js";import{_ as h}from"./ButtonTableOptions-ivpzFDPv.js";import{B as j}from"./Button-ByZOtwGJ.js";import{M as Z}from"./Modal-CwwUMTwV.js";import{g as G}from"./apiClient-Vvvjylwf.js";import"./QList-D6hH9GPe.js";import"./QSelect-CCFBgF8v.js";import"./QItemLabel-BiKvV_tR.js";import"./position-engine-BrzQKXCo.js";import"./selection-CjJDPdFp.js";import"./format-DyQxkAtJ.js";import"./QLinearProgress-C9Sex94R.js";import"./QTooltip-BIz5X8HU.js";const J={class:"full-width row"},K={class:"col-12"},W={class:"container"},X={class:"cards-container q-mb-xl"},Y={class:"q-pa-md flex flex-center column text-grey full-width"},aa={key:0,class:"row q-col-gutter-lg"},ea={class:"col-12 col-md-6"},oa={class:"data-grid"},ta={class:"data-row"},sa={class:"data-value"},la={class:"data-row"},ia={class:"data-value"},da={class:"data-row"},ra={class:"data-value"},na={class:"data-row"},ca={class:"data-value"},ua={class:"col-12 col-md-6"},va={class:"data-grid"},ma={class:"data-row"},pa={class:"data-value"},fa={class:"data-row"},ga={class:"data-value"},_a={class:"data-row"},ha={class:"data-value"},wa={class:"data-row"},ba={class:"data-value"},ya={__name:"ReportByModalityView",setup(xa){const m=N(),d=u({anio:m.query.anio||null,modalidad:m.query.modalidad||null,fechaInicio:m.query.fechaInicio||null,fechaFin:m.query.fechaFin||null}),v=u([{title:"TOTAL FICHAS",value:0},{title:"FICHAS FINALIZADAS",value:0},{title:"FICHAS EN PROCESO",value:0}]),F=[{name:"ficha",label:"Ficha",field:"ficha",align:"center"},{name:"programa",label:"Programa de Formacion",field:"nombre",align:"center"},{name:"aprendices",label:"Aprendices",field:"aprendices",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],g=u([]),_=u(!1),l=u(null),p=u(!1),I=async()=>{try{_.value=!0;const t=new URLSearchParams;d.value.anio&&t.append("anio",d.value.anio),d.value.modalidad&&t.append("modalidad",d.value.modalidad),d.value.fechaInicio&&t.append("fechaInicio",d.value.fechaInicio),d.value.fechaFin&&t.append("fechaFin",d.value.fechaFin);const e=`/reportes/modalidad${t.toString()?`?${t.toString()}`:""}`,o=await G(e),c=o.fichas||[];g.value=c.map(n=>({...n,ficha:n.ficha||n.code||"-",programa:n.nombre||n.programa||"-",aprendices:n.aprendices||0,estado:n.estado||"-"})),o.resumen&&(v.value[0].value=o.resumen.total||o.resumen.presencial||0,v.value[1].value=o.resumen.finalizadas||o.resumen.virtual||0,v.value[2].value=o.resumen.enProceso||o.resumen.mixta||0)}catch{g.value=[],v.value=[{title:"TOTAL FICHAS",value:0},{title:"FICHAS FINALIZADAS",value:0},{title:"FICHAS EN PROCESO",value:0}]}finally{_.value=!1}};B(()=>{I()});function S(t){return{Activo:"positive",Inactivo:"negative",Finalizado:"blue","En Proceso":"info",Pendiente:"orange"}[t]||"grey"}function w(t){return t?new Date(t).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):null}function A(t){return{1:"Contrato de aprendizaje",2:"Vínculo laboral",3:"Proyecto productivo",4:"Pasantía U.P. Familiar"}[t]||"No especificada"}const k=t=>{l.value=t,p.value=!0},P=t=>{},q=t=>{};return(t,e)=>(f(),b(H,{class:"q-pa-md report-view-page"},{default:i(()=>[s(O,{class:"q-mb-lg"}),a("div",J,[a("div",K,[s(V,{class:"shadow-1 hero-card q-mb-xl"},{default:i(()=>[s(M,null,{default:i(()=>[s($,{title:"Reporte por Modalidad",description:"Genera reportes filtrados por modalidad."})]),_:1})]),_:1}),a("div",W,[a("div",X,[(f(!0),y(E,null,Q(v.value,(o,c)=>(f(),b(z,{key:c,title:o.title,value:o.value,color:o.color},null,8,["title","value","color"]))),128))]),s(U,{card:"",rows:g.value,columns:F,"row-key":"_id",loading:_.value},{"body-cell-acciones":i(o=>[s(R,{props:o,class:"text-center table-options"},{default:i(()=>[s(h,{icon:"visibility",color:"grey",tooltip:"Ver detalle",onClick:c=>k(o.row)},null,8,["onClick"]),s(h,{icon:"file_download",color:"grey-7",tooltip:"Descargar",onClick:c=>P(o.row)},null,8,["onClick"]),s(h,{icon:"delete",color:"negative",tooltip:"Eliminar",onClick:c=>q(o.row)},null,8,["onClick"])]),_:2},1032,["props"])]),"no-data":i(()=>[a("div",Y,[s(T,{name:"calendar_month",size:"2.5em",color:"positive"}),e[2]||(e[2]=a("div",{class:"text-subtitle2 q-mt-sm"}," No se encontraron registros para los filtros seleccionados ",-1))])]),_:1},8,["rows","loading"])])])]),s(Z,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),width:"1200px","max-width":"98vw"},{header:i(()=>[...e[3]||(e[3]=[a("div",{class:"modal-header-content"},[a("div",{class:"text-h6"},"Detalles del Reporte por Modalidad")],-1)])]),body:i(()=>[l.value?(f(),y("div",aa,[a("div",ea,[e[8]||(e[8]=a("div",{class:"text-h6 q-mb-md section-title"},"Información de la Ficha",-1)),a("div",oa,[a("div",ta,[e[4]||(e[4]=a("div",{class:"text-weight-bold"},"Número de Ficha:",-1)),a("div",sa,r(l.value.ficha||"-"),1)]),a("div",la,[e[5]||(e[5]=a("div",{class:"text-weight-bold"},"Programa de Formación:",-1)),a("div",ia,r(l.value.programa||"-"),1)]),a("div",da,[e[6]||(e[6]=a("div",{class:"text-weight-bold"},"Total de Aprendices:",-1)),a("div",ra,[s(C,{color:"primary"},{default:i(()=>[x(r(l.value.aprendices||0)+" aprendices ",1)]),_:1})])]),a("div",na,[e[7]||(e[7]=a("div",{class:"text-weight-bold"},"Estado:",-1)),a("div",ca,[s(C,{color:S(l.value.estado)},{default:i(()=>[x(r(l.value.estado||"-"),1)]),_:1},8,["color"])])])])]),a("div",ua,[e[13]||(e[13]=a("div",{class:"text-h6 q-mb-md section-title"},"Información de Modalidad",-1)),a("div",va,[a("div",ma,[e[9]||(e[9]=a("div",{class:"text-weight-bold"},"Modalidad:",-1)),a("div",pa,r(A(l.value.modalidad)||"-"),1)]),a("div",fa,[e[10]||(e[10]=a("div",{class:"text-weight-bold"},"Fecha de Inicio:",-1)),a("div",ga,r(w(l.value.fechaInicio)||"-"),1)]),a("div",_a,[e[11]||(e[11]=a("div",{class:"text-weight-bold"},"Fecha de Fin:",-1)),a("div",ha,r(w(l.value.fechaFin)||"-"),1)]),a("div",wa,[e[12]||(e[12]=a("div",{class:"text-weight-bold"},"Duración:",-1)),a("div",ba,r(l.value.duracion||"N/A"),1)])])])])):L("",!0)]),footer:i(()=>[s(j,{label:"Cerrar","custom-class":"boton-cerrar",onClick:e[0]||(e[0]=o=>p.value=!1)})]),_:1},8,["modelValue"])]),_:1}))}},$a=D(ya,[["__scopeId","data-v-d15d2c77"]]);export{$a as default};

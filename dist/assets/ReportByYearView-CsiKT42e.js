import{_ as k,r as c,n as P,a5 as T,c as w,a as r,o as v,b as e,d as o,f as N,s as q,h as _,F as B,p as V,j as O,g as b,t as n,l as y}from"./index-D8k0Z2VW.js";import{Q as L}from"./QTd-Dz2_L_T4.js";import{Q as A}from"./QBadge-pToOuXWH.js";import{Q}from"./QPage-CDUm3vNP.js";import{B as R}from"./BackButton-OAicZK4q.js";import{P as H}from"./PageHeader-BZtJRD6F.js";import{S as $}from"./StatsCard-CWZ95buy.js";import{T as z}from"./Table-DrGgNztj.js";import{_ as g}from"./ButtonTableOptions-ivpzFDPv.js";import{B as M}from"./Button-ByZOtwGJ.js";import{M as Y}from"./Modal-CwwUMTwV.js";import{g as Z}from"./apiClient-Vvvjylwf.js";import"./QList-D6hH9GPe.js";import"./QSelect-CCFBgF8v.js";import"./QItemLabel-BiKvV_tR.js";import"./position-engine-BrzQKXCo.js";import"./selection-CjJDPdFp.js";import"./format-DyQxkAtJ.js";import"./QLinearProgress-C9Sex94R.js";import"./QTooltip-BIz5X8HU.js";const j={class:"full-width row"},U={class:"col-12"},G={class:"container"},J={class:"cards-container q-mb-xl"},K={class:"q-pa-md flex flex-center column text-grey full-width"},W={key:0,class:"row q-col-gutter-lg"},X={class:"col-12 col-md-6"},aa={class:"data-grid"},oa={class:"data-row"},ea={class:"data-value"},ta={class:"data-row"},sa={class:"data-value"},la={class:"data-row"},ia={class:"data-value"},ra={class:"data-row"},na={class:"data-value"},da={class:"col-12 col-md-6"},ca={class:"data-grid"},va={class:"data-row"},ua={class:"data-value"},ma={class:"data-row"},pa={class:"data-value"},fa={class:"data-row"},_a={class:"data-value"},ga={class:"data-row"},ha={class:"data-value"},wa={key:0,class:"col-12"},ba={class:"data-grid"},ya={class:"q-pa-md"},Aa={class:"text-body1"},xa={__name:"ReportByYearView",setup(Ca){const x=P(),m=c({anio:x.query.anio||null}),d=c([{title:"TOTAL DE FICHAS",value:0,color:"var(--color-primary)"},{title:"TOTAL DE APRENDICES",value:0,color:"var(--color-primary)"},{title:"FICHAS FINALIZADAS",value:0,color:"var(--color-primary)"},{title:"FICHAS EN PROCESO",value:0,color:"var(--color-primary)"}]),C=[{name:"ficha",label:"Ficha",field:"ficha",align:"center"},{name:"programa",label:"Programa de formación",field:"programa",align:"left"},{name:"aprendices",label:"Aprendices",field:"aprendices",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",align:"center"}],p=c([]),f=c(!1),l=c(null),u=c(!1),F=async()=>{try{f.value=!0;const i=`/reportes/anio${m.value.anio?`?anio=${m.value.anio}`:""}`,a=await Z(i),t=a.fichas||[];p.value=t.map(s=>({...s,ficha:s.ficha||s.code||"-",programa:s.nombre||s.programa||"-",aprendices:s.aprendices||s.totalAprendices||0,estado:s.estado||"-"})),a.resumen&&(d.value[0].value=a.resumen.totalFichas||a.resumen.activas||0,d.value[1].value=a.resumen.totalAprendices||a.resumen.finalizadas||0,d.value[2].value=a.resumen.fichasFinalizadas||a.resumen.canceladas||0,d.value[3].value=a.resumen.fichasEnProceso||a.resumen.enProceso||0)}catch{p.value=[],d.value=[{title:"TOTAL DE FICHAS",value:0,color:"var(--color-primary)"},{title:"TOTAL DE APRENDICES",value:0,color:"var(--color-primary)"},{title:"FICHAS FINALIZADAS",value:0,color:"var(--color-primary)"},{title:"FICHAS EN PROCESO",value:0,color:"var(--color-primary)"}]}finally{f.value=!1}};T(()=>{F()});function I(i){return{Activo:"positive",Inactivo:"negative",Finalizado:"blue","En Proceso":"info",Pendiente:"orange"}[i]||"grey"}function h(i){return i?new Date(i).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):null}const E=i=>{l.value=i,u.value=!0},D=i=>{},S=i=>{};return(i,a)=>(v(),w(Q,{class:"q-pa-md report-view-page"},{default:r(()=>[e(R,{class:"q-mb-lg"}),o("div",j,[o("div",U,[e(N,{class:"shadow-1 hero-card q-mb-xl"},{default:r(()=>[e(q,null,{default:r(()=>[e(H,{title:"Reporte por Año",description:"Analiza la información agregada por año."})]),_:1})]),_:1}),o("div",G,[o("div",J,[(v(!0),_(B,null,V(d.value,(t,s)=>(v(),w($,{key:s,title:t.title,value:t.value,color:t.color},null,8,["title","value","color"]))),128))]),e(z,{card:"",rows:p.value,columns:C,"row-key":"_id",loading:f.value},{"body-cell-acciones":r(t=>[e(L,{props:t,class:"text-center table-options"},{default:r(()=>[e(g,{icon:"visibility",color:"grey",tooltip:"Ver detalle",onClick:s=>E(t.row)},null,8,["onClick"]),e(g,{icon:"file_download",color:"grey-7",tooltip:"Descargar",onClick:s=>D(t.row)},null,8,["onClick"]),e(g,{icon:"delete",color:"negative",tooltip:"Eliminar",onClick:s=>S(t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),"no-data":r(()=>[o("div",K,[e(O,{name:"calendar_month",size:"2.5em",color:"positive"}),a[2]||(a[2]=o("div",{class:"text-subtitle2 q-mt-sm"}," No se encontraron fichas para el año seleccionado ",-1))])]),_:1},8,["rows","loading"])])])]),e(Y,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=t=>u.value=t),width:"1200px","max-width":"98vw"},{header:r(()=>[...a[3]||(a[3]=[o("div",{class:"modal-header-content"},[o("div",{class:"text-h6"},"Detalles del Reporte por Año")],-1)])]),body:r(()=>[l.value?(v(),_("div",W,[o("div",X,[a[8]||(a[8]=o("div",{class:"text-h6 q-mb-md section-title"},"Información de la Ficha",-1)),o("div",aa,[o("div",oa,[a[4]||(a[4]=o("div",{class:"text-weight-bold"},"Número de Ficha:",-1)),o("div",ea,n(l.value.ficha||"-"),1)]),o("div",ta,[a[5]||(a[5]=o("div",{class:"text-weight-bold"},"Programa de Formación:",-1)),o("div",sa,n(l.value.programa||"-"),1)]),o("div",la,[a[6]||(a[6]=o("div",{class:"text-weight-bold"},"Total de Aprendices:",-1)),o("div",ia,[e(A,{color:"primary"},{default:r(()=>[y(n(l.value.aprendices||0)+" aprendices ",1)]),_:1})])]),o("div",ra,[a[7]||(a[7]=o("div",{class:"text-weight-bold"},"Estado de la Ficha:",-1)),o("div",na,[e(A,{color:I(l.value.estado)},{default:r(()=>[y(n(l.value.estado||"-"),1)]),_:1},8,["color"])])])])]),o("div",da,[a[13]||(a[13]=o("div",{class:"text-h6 q-mb-md section-title"},"Información Académica",-1)),o("div",ca,[o("div",va,[a[9]||(a[9]=o("div",{class:"text-weight-bold"},"Año Académico:",-1)),o("div",ua,n(m.value.anio||"-"),1)]),o("div",ma,[a[10]||(a[10]=o("div",{class:"text-weight-bold"},"Fecha de Inicio:",-1)),o("div",pa,n(h(l.value.fechaInicio)||"-"),1)]),o("div",fa,[a[11]||(a[11]=o("div",{class:"text-weight-bold"},"Fecha de Fin:",-1)),o("div",_a,n(h(l.value.fechaFin)||"-"),1)]),o("div",ga,[a[12]||(a[12]=o("div",{class:"text-weight-bold"},"Tipo de Programa:",-1)),o("div",ha,n(l.value.tipoPrograma||"No especificado"),1)])])]),l.value.observaciones?(v(),_("div",wa,[a[14]||(a[14]=o("div",{class:"text-h6 q-mb-md section-title"},"Observaciones",-1)),o("div",ba,[o("div",ya,[o("p",Aa,n(l.value.observaciones),1)])])])):b("",!0)])):b("",!0)]),footer:r(()=>[e(M,{label:"Cerrar","custom-class":"boton-cerrar",onClick:a[0]||(a[0]=t=>u.value=!1)})]),_:1},8,["modelValue"])]),_:1}))}},Ya=k(xa,[["__scopeId","data-v-93b02bcd"]]);export{Ya as default};

import{_ as F,n as L,r as l,m as y,c as T,a as n,u as I,o as d,b as s,d as a,Q as q,e as z,f as $,j as c,h as f,g as h,i as Q,F as A,p as S,l as P,t as k}from"./index-D8k0Z2VW.js";import{Q as D,a as H,l as O,b as U,c as j,d as M}from"./LogoSENABlanco-CtklxWB6.js";import{Q as W}from"./QPageContainer-CjE1gXqS.js";import{u as Z}from"./useNotifications-C15CMF32.js";import{a as G}from"./apiClient-Vvvjylwf.js";import{B as J}from"./BackButton-OAicZK4q.js";import{B as K}from"./Button-ByZOtwGJ.js";const X={class:"header-content"},Y=["src"],ee={class:"main-wrapper"},se={class:"back-button-wrapper"},ae={class:"content-center"},oe={class:"icon-section"},te={class:"icon-container"},re={class:"input-wrapper"},ne={key:0,class:"error-messages"},le={class:"input-wrapper"},ie={key:0,class:"error-messages"},ue={class:"error-message"},de={class:"button-section"},ce={__name:"NewPassword",setup(me){const B=I(),x=L(),m=Z(),C=x.query.code,i=l(!1),t=l(""),u=l(""),v=l(!1),p=l(!1),w=l(!1),b=l(!1),g=y(()=>{const o=[];return t.value&&(t.value.length<8&&o.push("La contraseña debe tener al menos 8 caracteres"),/\d/.test(t.value)||o.push("La contraseña debe tener al menos 1 número"),/[a-z]/.test(t.value)||o.push("La contraseña debe tener al menos 1 letra minúscula"),/[A-Z]/.test(t.value)||o.push("La contraseña debe tener al menos 1 letra mayúscula")),o}),_=y(()=>u.value&&t.value!==u.value?"Las contraseñas no coinciden":""),N=y(()=>t.value&&u.value&&g.value.length===0&&!_.value);function V(){w.value=!0}function R(){b.value=!0}async function E(){i.value=!0;try{const o=x.query.email;if(!o){m.error("No se encontró el correo electrónico"),i.value=!1;return}if(!C){m.error("No se encontró el código de verificación"),i.value=!1;return}const e=await G(`/apprentices/updatePassword/${o}`,{codeResetPassword:C,newPassword:t.value});m.success(e.msg||e.message||"Contraseña cambiada exitosamente"),B.push("/")}catch(o){const e=o.response?.data?.msg||o.response?.data?.message||o.response?.data?.error||"Error al cambiar la contraseña. Intenta nuevamente.";m.error(e)}finally{i.value=!1}}return(o,e)=>(d(),T(D,{view:"hHh lpR fFf"},{default:n(()=>[s(H,{elevated:"",class:"text-white header-custom"},{default:n(()=>[a("div",X,[s(q,{class:"header-avatar"},{default:n(()=>[a("img",{src:z(O),class:"avatar-img"},null,8,Y)]),_:1}),e[6]||(e[6]=a("span",{class:"header-title"},"REPFORA EP",-1))])]),_:1}),s(W,{class:"page-container"},{default:n(()=>[a("div",ee,[a("div",se,[s(J,{size:48})]),a("div",ae,[s($,{class:"recovery-card",flat:""},{default:n(()=>[a("div",oe,[a("div",te,[s(c,{name:"lock",class:"icon-main",color:"green-6"})]),e[7]||(e[7]=a("div",{class:"title-section"}," Seguridad de su contraseña ",-1))]),e[10]||(e[10]=a("div",{class:"description-section"}," Crea una contraseña nueva y segura utilizando 8 caracteres como mínimo, al menos 1 número, 1 letra minúscula y 1 letra mayúscula. No uses contraseñas de otros sitios web ni un término que sea demasiado obvio. ",-1)),a("div",re,[e[8]||(e[8]=a("label",{class:"input-label"},"Nueva contraseña",-1)),s(Q,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value=r),type:v.value?"text":"password",outlined:"",class:"password-input",onBlur:V,onInput:e[2]||(e[2]=r=>w.value=!0)},{append:n(()=>[s(c,{name:v.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[0]||(e[0]=r=>v.value=!v.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),w.value&&g.value.length>0?(d(),f("div",ne,[(d(!0),f(A,null,S(g.value,r=>(d(),f("div",{key:r,class:"error-message"},[s(c,{name:"error",size:"18px",color:"red",class:"q-mr-xs"}),P(" "+k(r),1)]))),128))])):h("",!0)]),a("div",le,[e[9]||(e[9]=a("label",{class:"input-label"},"Confirmar nueva contraseña",-1)),s(Q,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=r=>u.value=r),type:p.value?"text":"password",outlined:"",class:"password-input",onBlur:R,onInput:e[5]||(e[5]=r=>b.value=!0)},{append:n(()=>[s(c,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[3]||(e[3]=r=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),b.value&&_.value?(d(),f("div",ie,[a("div",ue,[s(c,{name:"error",size:"18px",color:"red",class:"q-mr-xs"}),P(" "+k(_.value),1)])])):h("",!0)]),a("div",de,[s(K,{label:"Cambiar Contraseña","custom-class":"btn-enviar",onClick:E,loading:i.value,disable:!N.value},null,8,["loading","disable"])])]),_:1})])])]),_:1}),s(U,{class:"footer-custom"},{default:n(()=>[s(j,{class:"footer-toolbar"},{default:n(()=>[s(M,{class:"text-center footer-text"},{default:n(()=>[...e[11]||(e[11]=[P(" REPFORA - Sena 2025 © Todos los derechos reservados ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}))}},ye=F(ce,[["__scopeId","data-v-cdbad117"]]);export{ye as default};
